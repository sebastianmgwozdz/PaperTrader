{"ast":null,"code":"var _jsxFileName = \"/Users/sebastiangwozdz/Desktop/papertrader/src/PositionsComponents/TradeText.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { List } from \"antd\";\nimport { get } from \"../Helpers\";\nimport { withFirebase } from \"../Firebase\";\n\nfunction TradeText(props) {\n  const [text, setText] = useState(null);\n  const {\n    quantity,\n    symbol,\n    type,\n    balance,\n    price\n  } = props;\n  useEffect(() => {\n    update();\n  }, [quantity, symbol, type, price]);\n\n  async function sharesOwned(long) {\n    let shares = 0;\n    await get(server + \"positions/id=\" + props.firebase.auth.currentUser.uid + \"/ticker=\" + symbol + \"/active\").then(res => {\n      for (let pos of res) {\n        if (pos[\"isLong\"] === long) {\n          shares += pos[\"remaining\"];\n        }\n      }\n    });\n    return shares;\n  }\n\n  function close(numShares) {\n    get(server + \"positions/id=\" + props.firebase.auth.currentUser.uid + \"/ticker=\" + symbol + \"/active\").then(res => {\n      let closed = 0;\n      let am = 0;\n\n      for (let p of res) {\n        let shares = p[\"remaining\"];\n        let remSell = quantity - closed;\n        let sellAll = shares <= remSell;\n        am += (sellAll ? remSell : quantity) * (type === 1 ? price : p[\"price\"] * 100 - price);\n        closed += sellAll ? remSell : quantity;\n      }\n\n      setText([\"Current Shares: \" + numShares, \"Remaining Shares: \" + (numShares - quantity), \"Current Balance: $\" + balance / 100, \"New Balance: $\" + (balance + am) / 100]);\n    });\n  }\n\n  async function update() {\n    if (!symbol || quantity === 0) {\n      setText(null);\n      return;\n    }\n\n    switch (type) {\n      case 0:\n        setText([\"Current Balance: $\" + (balance / 100).toFixed(2), \"New Balance: $\" + ((balance - price * quantity) / 100).toFixed(2)]);\n        break;\n\n      case 2:\n        setText([\"Total Value: $\" + (quantity * price / 100).toFixed(2)]);\n        break;\n\n      default:\n        sharesOwned(true).then(res => {\n          close(res);\n        });\n        break;\n    }\n  }\n\n  if (!text) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(List, {\n    size: \"small\",\n    bordered: true,\n    dataSource: text,\n    renderItem: item => /*#__PURE__*/React.createElement(List.Item, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 29\n      }\n    }, item),\n    style: props.style,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }\n  });\n}\n\nexport default withFirebase(TradeText);","map":{"version":3,"sources":["/Users/sebastiangwozdz/Desktop/papertrader/src/PositionsComponents/TradeText.js"],"names":["React","useState","useEffect","List","get","withFirebase","TradeText","props","text","setText","quantity","symbol","type","balance","price","update","sharesOwned","long","shares","server","firebase","auth","currentUser","uid","then","res","pos","close","numShares","closed","am","p","remSell","sellAll","toFixed","item","style"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { List } from \"antd\";\nimport { get } from \"../Helpers\";\nimport { withFirebase } from \"../Firebase\";\n\nfunction TradeText(props) {\n  const [text, setText] = useState(null);\n\n  const { quantity, symbol, type, balance, price } = props;\n\n  useEffect(() => {\n    update();\n  }, [quantity, symbol, type, price]);\n\n  async function sharesOwned(long) {\n    let shares = 0;\n\n    await get(\n      server +\n        \"positions/id=\" +\n        props.firebase.auth.currentUser.uid +\n        \"/ticker=\" +\n        symbol +\n        \"/active\"\n    ).then((res) => {\n      for (let pos of res) {\n        if (pos[\"isLong\"] === long) {\n          shares += pos[\"remaining\"];\n        }\n      }\n    });\n\n    return shares;\n  }\n\n  function close(numShares) {\n    get(\n      server +\n        \"positions/id=\" +\n        props.firebase.auth.currentUser.uid +\n        \"/ticker=\" +\n        symbol +\n        \"/active\"\n    ).then((res) => {\n      let closed = 0;\n      let am = 0;\n      for (let p of res) {\n        let shares = p[\"remaining\"];\n        let remSell = quantity - closed;\n        let sellAll = shares <= remSell;\n\n        am +=\n          (sellAll ? remSell : quantity) *\n          (type === 1 ? price : p[\"price\"] * 100 - price);\n        closed += sellAll ? remSell : quantity;\n      }\n      setText([\n        \"Current Shares: \" + numShares,\n        \"Remaining Shares: \" + (numShares - quantity),\n        \"Current Balance: $\" + balance / 100,\n        \"New Balance: $\" + (balance + am) / 100,\n      ]);\n    });\n  }\n\n  async function update() {\n    if (!symbol || quantity === 0) {\n      setText(null);\n      return;\n    }\n\n    switch (type) {\n      case 0:\n        setText([\n          \"Current Balance: $\" + (balance / 100).toFixed(2),\n          \"New Balance: $\" + ((balance - price * quantity) / 100).toFixed(2),\n        ]);\n        break;\n\n      case 2:\n        setText([\"Total Value: $\" + ((quantity * price) / 100).toFixed(2)]);\n        break;\n      default:\n        sharesOwned(true).then((res) => {\n          close(res);\n        });\n        break;\n    }\n  }\n\n  if (!text) {\n    return null;\n  }\n\n  return (\n    <List\n      size=\"small\"\n      bordered\n      dataSource={text}\n      renderItem={(item) => <List.Item>{item}</List.Item>}\n      style={props.style}\n    />\n  );\n}\n\nexport default withFirebase(TradeText);\n"]},"metadata":{},"sourceType":"module"}